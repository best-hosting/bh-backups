---
# defaults file for bh-backups
install_path: '/etc'

# FIXME: Make 'rsync_filters' consitent with 'script' option: 'script'
# specifies file name with script, so should 'rsync_filter' do. I also may
# provide 'script_name' option for choosing default scripts.
default_rsync_filters: >-
  {{
      { 'root': role_path + '/' + 'templates/default_root_rsync_filter.yml'
      , 'home': role_path + '/' + 'templates/default_home_rsync_filter.yml'
      }
  }}

# Backup points definition.
# 'src' - (required) Name of source directory on backed up server.
# 'dst' - (required) Name of destination directory on _backup_ server.
# 'name' - (optional) Id, which will be used to identify this backup point and
# all related resources. Ids should be unique among _both_ backup points and
# backup scripts. If not specified, it'll be derived automatically from 'dst'.
# 'rsync_filter_name' - (optional) name of default rsync filter to use.
# 'rsync_filter' - (optional) path to rsync filter file. If not specified,
# default rsync filter with name 'rsync_filter_name' will be looked up. If
# 'rsync_filter_name' is also not specified, default rsync filter will be
# looked up by backup point 'name'. And if that also fails, task fails.
#
# All other attributes are ignored.
#r_backups:
#  - name: 'root'
#    src:  '/'
#    dst:  'root'
#    rsync_filter: "{{ bh_root_rsync_filter }}"

bh_mysql_script: "{{ role_path + '/files/mysql.sh' }}"
bh_pgsql_script: "{{ role_path + '/files/pgsql.sh' }}"

# Backup scripts definition. Name must be unique in single r_backup_scripts
# list!
#r_backup_scripts:
#  - name:   'mysql'
#    password: 'pass'
#    script: "{{ bh_mysql_script }}"

# Root directory for all backups. This variable must be set for _backup
# server_.
#r_backup_root: '/var/cache/rsnapshot'

# Default database user name.
db_user: "{{ backup_server }}"

# Default database user password.
db_password: "{{ lookup('file', 'backup_mysql_' + inventory_hostname + '.password') }}"

r_sync:
  hour: 2
  minute: 30
r_weekly:
  hour: 2
  minute: 15
r_monthly:
  hour: 2
  minute: 0

# To recalculate values for backup point, remove it from cache file.
r_count_files: yes

# Percentage.
warn_files_count: 80
crit_files_count: 60
warn_files_count_diff: 10000
crit_files_count_diff: 40000

warn_size: 80
crit_size: 60
warn_size_diff: 10737418240
crit_size_diff: 42949672960

# Whether to install or uninstall rsnapshot configs. Note, that rsync filter
# library files, directories and all backup data will _not_ be uninstalled in
# any case.
run_mode: 'install'
